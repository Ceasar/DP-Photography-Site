This ought to work without any trouble.

First thing I want to do is figure out what the code does, comment it,
and rename variables and functions so that it's extremely intuitive.

SESSION active refers to if the person is logged in.